CREATE VIEW w_stg_loan_insurance  AS     SELECT pa.account_number           ,pa.account_ser_num           ,l.fk_unitcode           ,l.acc_type           ,l.acc_sn           ,NVL (SUM (ip.monthly_premium * l.install_freq), 0) insurance_amount     FROM   loan_account l            JOIN profits_account pa               ON     pa.prft_system = 4                  AND pa.lns_open_unit = l.fk_unitcode                  AND pa.lns_sn = l.acc_sn                  AND pa.lns_type = l.acc_type            JOIN iss_premium_calc ip               ON     ip.fk_prft_acc_number = pa.account_number                  AND ip.fk_prft_system = 4            JOIN iss_commitment isc               ON     isc.tp_so_identifier = ip.fk_tp_so_identifier                  AND isc.entry_status = '06'     GROUP BY l.fk_unitcode             ,l.acc_type             ,l.acc_sn             ,pa.account_number             ,pa.account_ser_num;

