CREATE VIEW FX_OPEN_POS_MNT (
    TRX_DATE,
	TRX_UNIT,
	TRX_USER,
	TRX_USR_SN,
	ACC_CURRENCY_60,
	ACC_AMOUNT_60,
	ACC_CURRENCY_59,
	ACC_AMOUNT_59,
	ACC_CURRENCY_58,
	ACC_AMOUNT_58,
	ACC_CURRENCY_57,
	ACC_AMOUNT_57,
	ACC_CURRENCY_56,
	ACC_AMOUNT_56,
	ACC_CURRENCY_55,
	ACC_AMOUNT_55,
	ACC_CURRENCY_54,
	ACC_AMOUNT_54,
	ACC_CURRENCY_53,
	ACC_AMOUNT_53,
	ACC_CURRENCY_52,
	ACC_AMOUNT_52,
	ACC_CURRENCY_51,
	ACC_AMOUNT_51,
	ACC_CURRENCY_50,
	ACC_AMOUNT_50,
	ACC_CURRENCY_49,
	ACC_AMOUNT_49,
	ACC_CURRENCY_48,
	ACC_AMOUNT_48,
	ACC_CURRENCY_47,
	ACC_AMOUNT_47,
	ACC_CURRENCY_46,
	ACC_AMOUNT_46,
	ACC_CURRENCY_45,
	ACC_AMOUNT_45,
	ACC_CURRENCY_44,
	ACC_AMOUNT_44,
	ACC_CURRENCY_43,
	ACC_AMOUNT_43,
	ACC_CURRENCY_42,
	ACC_AMOUNT_42,
	ACC_CURRENCY_41,
	ACC_AMOUNT_41,
	ACC_CURRENCY_40,
	ACC_AMOUNT_40,
	ACC_CURRENCY_39,
	ACC_AMOUNT_39,
	ACC_CURRENCY_38,
	ACC_AMOUNT_38,
	ACC_CURRENCY_37,
	ACC_AMOUNT_37,
	ACC_CURRENCY_36,
	ACC_AMOUNT_36,
	ACC_CURRENCY_35,
	ACC_AMOUNT_35,
	ACC_CURRENCY_33,
	ACC_AMOUNT_33,
	ACC_CURRENCY_32,
	ACC_AMOUNT_32,
	ACC_CURRENCY_31,
	ACC_AMOUNT_31,
	ACC_CURRENCY_30,
	ACC_AMOUNT_30,
	ACC_CURRENCY_29,
	ACC_AMOUNT_29,
	ACC_CURRENCY_28,
	ACC_AMOUNT_28,
	ACC_CURRENCY_27,
	ACC_AMOUNT_27,
	ACC_CURRENCY_26,
	ACC_AMOUNT_26,
	ACC_CURRENCY_25,
	ACC_AMOUNT_25,
	ACC_CURRENCY_24,
	ACC_AMOUNT_24,
	ACC_CURRENCY_23,
	ACC_AMOUNT_23,
	ACC_CURRENCY_22,
	ACC_AMOUNT_22,
	ACC_CURRENCY_21,
	ACC_AMOUNT_21,
	ACC_CURRENCY_20,
	ACC_AMOUNT_20,
	ACC_CURRENCY_19,
	ACC_AMOUNT_19,
	ACC_CURRENCY_18,
	ACC_AMOUNT_18,
	ACC_CURRENCY_17,
	ACC_AMOUNT_17,
	ACC_CURRENCY_16,
	ACC_AMOUNT_16,
	ACC_CURRENCY_15,
	ACC_AMOUNT_15,
	ACC_CURRENCY_14,
	ACC_AMOUNT_14,
	ACC_CURRENCY_13,
	ACC_AMOUNT_13,
	ACC_CURRENCY_12,
	ACC_AMOUNT_12,
	ACC_CURRENCY_10,
	ACC_AMOUNT_10,
	ACC_CURRENCY_8,
	ACC_AMOUNT_8,
	ACC_CURRENCY_7,
	ACC_AMOUNT_7,
	ACC_CURRENCY_6,
	ACC_AMOUNT_6,
	ACC_CURRENCY_3,
	ACC_AMOUNT_3,
	ACC_CURRENCY_1,
	ACC_AMOUNT_1,
	ACC_AMOUNT_5,
	ACC_AMOUNT_2,
	ACC_CURRENCY_2,
	ACC_CURRENCY_5,
	ACC_AMOUNT_9,
	ACC_CURRENCY_9,
	ACC_AMOUNT_11,
	ACC_CURRENCY_11,
	ACC_AMOUNT_34,
	ACC_CURRENCY_34,
	DR_INT_ACCR_GL_LVL,
	DR_INT_ACCR_GL_ACC,
	DR_INT_GL_ACC_LVL,
	DR_INT_GL_ACC,
	DR_CNTR_GL_ACC_LVL,
	DR_CNTR_GL_ACC,
	GL_ACCRUAL_LVL,
	GL_ACCRUAL_ACC,
	GL_NETWORK_LVL,
	GL_NETWORK_ACC,
	CHR_ID_CURRENCY,
	ACC_UNIT,
	CUST_ID,
	I_TUN_UNIT,
	ACCOUNTED_FLAG,
	CR_INT_ACCR_GL_LVL,
	CR_INT_ACCR_GL_ACC,
	CR_INT_GL_ACC_LVL,
	CR_INT_GL_ACC,
	CR_CNTR_GL_ACC_LVL,
	CR_CNTR_GL_ACC,
	ACC_CURRENCY_4,
	ACC_AMOUNT_4,
	GRP_SUBSCRIPT,
	PRFT_SYSTEM,
	TRX_CODE,
	TRX_ID_CURRENCY,
	ACC_ID_CURRENCY,
	REVERSAL_FLAG,
	TERMINAL_NUMBER,
	CHANNEL_ID,
	ID_PRODUCT,
	ID_JUSTIFIC,
	AUTHORIZER1,
	AUTHORIZER2,
	TMSTAMP,
	TRX_DETAILS,
	FIXING_RATE,
	ACCOUNTING_RULE_ID
)
AS
    SELECT
    TRX_DATE,
	TRX_UNIT,
	TRX_USER,
	TRX_USR_SN,
	ACC_CURRENCY_60,
	ACC_AMOUNT_60,
	ACC_CURRENCY_59,
	ACC_AMOUNT_59,
	ACC_CURRENCY_58,
	ACC_AMOUNT_58,
	ACC_CURRENCY_57,
	ACC_AMOUNT_57,
	ACC_CURRENCY_56,
	ACC_AMOUNT_56,
	ACC_CURRENCY_55,
	ACC_AMOUNT_55,
	ACC_CURRENCY_54,
	ACC_AMOUNT_54,
	ACC_CURRENCY_53,
	ACC_AMOUNT_53,
	ACC_CURRENCY_52,
	ACC_AMOUNT_52,
	ACC_CURRENCY_51,
	ACC_AMOUNT_51,
	ACC_CURRENCY_50,
	ACC_AMOUNT_50,
	ACC_CURRENCY_49,
	ACC_AMOUNT_49,
	ACC_CURRENCY_48,
	ACC_AMOUNT_48,
	ACC_CURRENCY_47,
	ACC_AMOUNT_47,
	ACC_CURRENCY_46,
	ACC_AMOUNT_46,
	ACC_CURRENCY_45,
	ACC_AMOUNT_45,
	ACC_CURRENCY_44,
	ACC_AMOUNT_44,
	ACC_CURRENCY_43,
	ACC_AMOUNT_43,
	ACC_CURRENCY_42,
	ACC_AMOUNT_42,
	ACC_CURRENCY_41,
	ACC_AMOUNT_41,
	ACC_CURRENCY_40,
	ACC_AMOUNT_40,
	ACC_CURRENCY_39,
	ACC_AMOUNT_39,
	ACC_CURRENCY_38,
	ACC_AMOUNT_38,
	ACC_CURRENCY_37,
	ACC_AMOUNT_37,
	ACC_CURRENCY_36,
	ACC_AMOUNT_36,
	ACC_CURRENCY_35,
	ACC_AMOUNT_35,
	ACC_CURRENCY_33,
	ACC_AMOUNT_33,
	ACC_CURRENCY_32,
	ACC_AMOUNT_32,
	ACC_CURRENCY_31,
	ACC_AMOUNT_31,
	ACC_CURRENCY_30,
	ACC_AMOUNT_30,
	ACC_CURRENCY_29,
	ACC_AMOUNT_29,
	ACC_CURRENCY_28,
	ACC_AMOUNT_28,
	ACC_CURRENCY_27,
	ACC_AMOUNT_27,
	ACC_CURRENCY_26,
	ACC_AMOUNT_26,
	ACC_CURRENCY_25,
	ACC_AMOUNT_25,
	ACC_CURRENCY_24,
	ACC_AMOUNT_24,
	ACC_CURRENCY_23,
	ACC_AMOUNT_23,
	ACC_CURRENCY_22,
	ACC_AMOUNT_22,
	ACC_CURRENCY_21,
	ACC_AMOUNT_21,
	ACC_CURRENCY_20,
	ACC_AMOUNT_20,
	ACC_CURRENCY_19,
	ACC_AMOUNT_19,
	ACC_CURRENCY_18,
	ACC_AMOUNT_18,
	ACC_CURRENCY_17,
	ACC_AMOUNT_17,
	ACC_CURRENCY_16,
	ACC_AMOUNT_16,
	ACC_CURRENCY_15,
	ACC_AMOUNT_15,
	ACC_CURRENCY_14,
	ACC_AMOUNT_14,
	ACC_CURRENCY_13,
	ACC_AMOUNT_13,
	ACC_CURRENCY_12,
	ACC_AMOUNT_12,
	ACC_CURRENCY_10,
	ACC_AMOUNT_10,
	ACC_CURRENCY_8,
	ACC_AMOUNT_8,
	ACC_CURRENCY_7,
	ACC_AMOUNT_7,
	ACC_CURRENCY_6,
	ACC_AMOUNT_6,
	ACC_CURRENCY_3,
	ACC_AMOUNT_3,
	ACC_CURRENCY_1,
	ACC_AMOUNT_1,
	ACC_AMOUNT_5,
	ACC_AMOUNT_2,
	ACC_CURRENCY_2,
	ACC_CURRENCY_5,
	ACC_AMOUNT_9,
	ACC_CURRENCY_9,
	ACC_AMOUNT_11,
	ACC_CURRENCY_11,
	ACC_AMOUNT_34,
	ACC_CURRENCY_34,
	DR_INT_ACCR_GL_LVL,
	DR_INT_ACCR_GL_ACC,
	DR_INT_GL_ACC_LVL,
	DR_INT_GL_ACC,
	DR_CNTR_GL_ACC_LVL,
	DR_CNTR_GL_ACC,
	GL_ACCRUAL_LVL,
	GL_ACCRUAL_ACC,
	GL_NETWORK_LVL,
	GL_NETWORK_ACC,
	CHR_ID_CURRENCY,
	ACC_UNIT,
	CUST_ID,
	I_TUN_UNIT,
	ACCOUNTED_FLAG,
	CR_INT_ACCR_GL_LVL,
	CR_INT_ACCR_GL_ACC,
	CR_INT_GL_ACC_LVL,
	CR_INT_GL_ACC,
	CR_CNTR_GL_ACC_LVL,
	CR_CNTR_GL_ACC,
	ACC_CURRENCY_4,
	ACC_AMOUNT_4,
	GRP_SUBSCRIPT,
	PRFT_SYSTEM,
	TRX_CODE,
	TRX_ID_CURRENCY,
	ACC_ID_CURRENCY,
	REVERSAL_FLAG,
	TERMINAL_NUMBER,
	CHANNEL_ID,
	ID_PRODUCT,
	ID_JUSTIFIC,
	AUTHORIZER1,
	AUTHORIZER2,
	TMSTAMP,
	TRX_DETAILS,
	FIXING_RATE,
	ACCOUNTING_RULE_ID
    FROM
        MNT_RECORDING dtr
    WHERE dtr.TRX_DATE = (SELECT CURR_TRX_DATE FROM BANK_PARAMETERS bp)   AND dtr.ACC_ID_CURRENCY != (SELECT ID_CURRENCY FROM CURRENCY WHERE NATIONAL_FLAG = '1' )	AND dtr.ACCOUNTED_FLAG = '0'	AND dtr.TRX_UNIT >= 0
	AND NOT EXISTS (SELECT * FROM FX_OPEN_POS_HDR foph WHERE dtr.TRX_UNIT= foph.TRX_UNIT AND dtr.TRX_DATE= foph.TRX_DATE AND dtr.TRX_USER= foph.TRX_USR AND dtr.TRX_USR_SN = foph.TRX_SN);

