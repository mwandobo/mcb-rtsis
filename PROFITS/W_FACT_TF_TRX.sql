CREATE VIEW W_FACT_TF_TRX  AS  SELECT tun_date trx_date          ,tun_unit trx_unit          ,tun_user trx_user          ,tun_trn_sn trx_sn          ,tun_internal_sn tun_internal_sn          ,tmpstamp tmstamp          ,tf_trx_recording.trx_code trx_code          ,prft_transaction.description transaction_name          ,tf_trx_recording.o_justific justification_code          ,justific.description justification_name          ,comments          ,TRIM(acc.account_number) || '-' || acc.account_cd account_no          ,currency.short_descr currency          ,id_currency currency_id          ,DECODE (tf_trx_recording.reversal_flg, '1', 'Reversal', 'Original')              reversal_flag          ,tf_trx_recording.trn_type          ,DECODE (tf_trx_recording.trn_type                  ,'0', 'Non-financial'                  ,'1', 'Cash Debit'                  ,'2', 'Cash Credit'                  ,'3', 'Journal Debit'                  ,'4', 'Journal Credit'                  ,'5', 'Memo Debit'                  ,'6', 'Memo Credit'                  ,'7', 'Debit Reversal'                  ,'8', 'Credit Reversal'                  ,'A', 'Journal Credit/Debit'                  ,'n/a')              trn_type_ind          ,'Posted' transaction_status_flag          ,acc.account_ser_num acct_key          ,CASE              WHEN NVL (tf_trx_recording.trn_type, '0') IN (' ', '0')              THEN                 'Non-financial'              ELSE                 'Financial'               END              financial_flag          ,DECODE (tf_trx_recording.trn_type, '1', 1, 0) * commission_amn              cash_debit_amt          ,DECODE (tf_trx_recording.trn_type, '2', 1, 0) * commission_amn              cash_credit_amt          ,  DECODE (tf_trx_recording.trn_type,  'A', 1,  '3', 1,  0)           * commission_amn              journal_debit_amt          ,  DECODE (tf_trx_recording.trn_type,  'A', 1,  '4', 1,  0)           * commission_amn              journal_credit_amt        FROM   tf_trx_recording           LEFT JOIN profits_account acc ON (tf_acc_number = acc.account_number)           LEFT JOIN currency              ON currency.id_currency = tf_trx_recording.o_charging_currency           LEFT JOIN justific              ON justific.id_justific = tf_trx_recording.o_justific           LEFT JOIN prft_transaction              ON prft_transaction.id_transact = tf_trx_recording.trx_code  WITH NO ROW MOVEMENT;

