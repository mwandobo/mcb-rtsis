CREATE VIEW CALENDAR_BNS_DAYS_VW  (     DAY_ID,     WEEK_NUM,     YR_WORK_DAY_NUM,     YR_DAY_NUM,     DATE_ID,     HOLIDAY_IND,     DAY_NAME,     WD_SN,     DAY_ID_B,     WEEK_NUM_B,     YR_WORK_DAY_NUM_B,     YR_DAY_NUM_B,     DATE_ID_B,     HOLIDAY_IND_B,     DAY_NAME_B,     WD_SN_B  )  AS     WITH t          AS (SELECT calendar.*,                     RANK () OVER (PARTITION BY holiday_ind ORDER BY day_id)                        wd_sn                FROM calendar)  SELECT * FROM  (       SELECT a.day_id,              a.week_num,              a.yr_work_day_num,              a.yr_day_num,              a.date_id,              a.holiday_ind,              a.day_name,              a.wd_sn,              b.day_id day_id_b,              b.week_num week_num_b,              b.yr_work_day_num yr_work_day_num_b,              b.yr_day_num yr_day_num_b,              b.date_id date_id_b,              b.holiday_ind holiday_ind_b,              b.day_name day_name_b,              b.wd_sn wd_sn_b         FROM (SELECT * FROM t) a CROSS JOIN (SELECT * FROM t) b        WHERE a.holiday_ind = 0 AND b.holiday_ind = 0     ORDER BY a.day_id  );

