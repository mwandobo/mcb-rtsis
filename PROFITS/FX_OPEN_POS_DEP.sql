CREATE VIEW FX_OPEN_POS_DEP (
    TRX_DATE,
	TRX_UNIT,
	TRX_USR,
	TRX_USR_SN,
	TUN_INTERNAL_SN,
	ACC_AMOUNT_1,
	ACC_AMOUNT_2,
	ACC_AMOUNT_3,
	ACC_AMOUNT_4,
	ACC_AMOUNT_5,
	ACC_AMOUNT_6,
	ACC_AMOUNT_7,
	ACC_AMOUNT_8,
	ACC_AMOUNT_9,
	ACC_AMOUNT_10,
	ACC_AMOUNT_11,
	ACC_AMOUNT_12,
	ACC_AMOUNT_13,
	ACC_AMOUNT_14,
	ACC_AMOUNT_15,
	ACC_AMOUNT_16,
	ACC_AMOUNT_17,
	ACC_AMOUNT_18,
	ACC_AMOUNT_19,
	ACC_AMOUNT_20,
	ACC_AMOUNT_21,
	ACC_AMOUNT_22,
	ACC_AMOUNT_23,
	ACC_AMOUNT_24,
	ACC_AMOUNT_25,
	ACC_AMOUNT_26,
	ACC_AMOUNT_27,
	ACC_AMOUNT_28,
	ACC_AMOUNT_29,
	ACC_AMOUNT_30,
	ACC_AMOUNT_31,
	ACC_AMOUNT_32,
	ACC_AMOUNT_33,
	ACC_AMOUNT_34,
	ACC_AMOUNT_35,
	ACC_AMOUNT_36,
	ACC_AMOUNT_37,
	ACC_AMOUNT_38,
	ACC_AMOUNT_39,
	ACC_AMOUNT_40,
	ACC_AMOUNT_41,
	ACC_AMOUNT_42,
	ACC_AMOUNT_43,
	ACC_AMOUNT_44,
	ACC_AMOUNT_45,
	ACC_AMOUNT_46,
	ACC_AMOUNT_47,
	ACC_AMOUNT_48,
	ACC_AMOUNT_49,
	ACC_AMOUNT_50,
	ACC_AMOUNT_52,
	ACC_AMOUNT_53,
	GL_ACC,
	TRN_TYPE,
	ACCOUNTED_FLAG,
	DR_GL_ACCR_INT_LVL,
	DR_GL_ACCR_INT_ACC,
	DR_GL_INTEREST_LVL,
	DR_GL_INTEREST_ACC,
	DR_GL_ACCOUNT_LVL,
	DR_GL_ACCOUNT,
	GL_NETWORK_LVL,
	GL_NETWORK_ACC,
	GL_ACCRUAL_INT_LVL,
	GL_ACCRUAL_INT_ACC,
	GL_ACCRUAL_LVL,
	GL_ACCRUAL_ACC,
	GL_INTEREST_LVL,
	GL_INTEREST_ACC,
	GL_LVL,
	GL_RULE_CODE,
	CUST_ID1,
	ACC_UNIT_CODE,
	O_FIXING_RATE,
	I_TRX_UNIT,
	ACC_ID_CURRENCY,
	TRANSACTION_STATUS,
	TRX_CODE,
	I_CUSTOMER_ID_NO,
	ID_PRODUCT,
	I_ID_JUSTIFIC,
	U_CREDIT_INT_TAX,
	U_DEBIT_INT_TAX,
	I_BENEFICIARY_SN,
	I_APPROVAL_TUN,
	U_USER_TOT_DOC_CNT,
	P_AVAILABLE_BAL,
	O_ENCHROACH_TOLLER,
	I_FORECAST_FLAG,
	I_REFERENCE_NUMBER,
	I_COMMENTS,
	I_AMOUNT,
	O_FINAL_ACC_AMOUNT,
	I_ACCOUNT_NUMBER,
	O_CHEQUE_STATUS,
	P_CHEQUE_STATUS,
	U_USER_TOTALS_AMN
)
AS
    SELECT
        TRX_DATE,
	TRX_UNIT,
	TRX_USR,
	TRX_USR_SN,
	TUN_INTERNAL_SN,
	ACC_AMOUNT_1,
	ACC_AMOUNT_2,
	ACC_AMOUNT_3,
	ACC_AMOUNT_4,
	ACC_AMOUNT_5,
	ACC_AMOUNT_6,
	ACC_AMOUNT_7,
	ACC_AMOUNT_8,
	ACC_AMOUNT_9,
	ACC_AMOUNT_10,
	ACC_AMOUNT_11,
	ACC_AMOUNT_12,
	ACC_AMOUNT_13,
	ACC_AMOUNT_14,
	ACC_AMOUNT_15,
	ACC_AMOUNT_16,
	ACC_AMOUNT_17,
	ACC_AMOUNT_18,
	ACC_AMOUNT_19,
	ACC_AMOUNT_20,
	ACC_AMOUNT_21,
	ACC_AMOUNT_22,
	ACC_AMOUNT_23,
	ACC_AMOUNT_24,
	ACC_AMOUNT_25,
	ACC_AMOUNT_26,
	ACC_AMOUNT_27,
	ACC_AMOUNT_28,
	ACC_AMOUNT_29,
	ACC_AMOUNT_30,
	ACC_AMOUNT_31,
	ACC_AMOUNT_32,
	ACC_AMOUNT_33,
	ACC_AMOUNT_34,
	ACC_AMOUNT_35,
	ACC_AMOUNT_36,
	ACC_AMOUNT_37,
	ACC_AMOUNT_38,
	ACC_AMOUNT_39,
	ACC_AMOUNT_40,
	ACC_AMOUNT_41,
	ACC_AMOUNT_42,
	ACC_AMOUNT_43,
	ACC_AMOUNT_44,
	ACC_AMOUNT_45,
	ACC_AMOUNT_46,
	ACC_AMOUNT_47,
	ACC_AMOUNT_48,
	ACC_AMOUNT_49,
	ACC_AMOUNT_50,
	ACC_AMOUNT_52,
	ACC_AMOUNT_53,
	GL_ACC,
	TRN_TYPE,
	ACCOUNTED_FLAG,
	DR_GL_ACCR_INT_LVL,
	DR_GL_ACCR_INT_ACC,
	DR_GL_INTEREST_LVL,
	DR_GL_INTEREST_ACC,
	DR_GL_ACCOUNT_LVL,
	DR_GL_ACCOUNT,
	GL_NETWORK_LVL,
	GL_NETWORK_ACC,
	GL_ACCRUAL_INT_LVL,
	GL_ACCRUAL_INT_ACC,
	GL_ACCRUAL_LVL,
	GL_ACCRUAL_ACC,
	GL_INTEREST_LVL,
	GL_INTEREST_ACC,
	GL_LVL,
	GL_RULE_CODE,
	CUST_ID1,
	ACC_UNIT_CODE,
	O_FIXING_RATE,
	I_TRX_UNIT,
	ACC_ID_CURRENCY,
	TRANSACTION_STATUS,
	TRX_CODE,
	I_CUSTOMER_ID_NO,
	ID_PRODUCT,
	I_ID_JUSTIFIC,
	U_CREDIT_INT_TAX,
	U_DEBIT_INT_TAX,
	I_BENEFICIARY_SN,
	I_APPROVAL_TUN,
	U_USER_TOT_DOC_CNT,
	P_AVAILABLE_BAL,
	O_ENCHROACH_TOLLER,
	I_FORECAST_FLAG,
	I_REFERENCE_NUMBER,
	I_COMMENTS,
	I_AMOUNT,
	O_FINAL_ACC_AMOUNT,
	I_ACCOUNT_NUMBER,
	O_CHEQUE_STATUS,
	P_CHEQUE_STATUS,
	U_USER_TOTALS_AMN
    FROM
        DEP_TRX_RECORDING dtr
    WHERE dtr.TRX_DATE = (SELECT CURR_TRX_DATE FROM BANK_PARAMETERS bp) AND dtr.ACC_ID_CURRENCY != (SELECT ID_CURRENCY FROM CURRENCY WHERE NATIONAL_FLAG = '1' )	AND dtr.ACCOUNTED_FLAG = '0'	AND dtr.TRX_UNIT >= 0
	AND NOT EXISTS (SELECT * FROM FX_OPEN_POS_HDR foph WHERE dtr.TRX_UNIT= foph.TRX_UNIT AND dtr.TRX_DATE= foph.TRX_DATE AND dtr.TRX_USR= foph.TRX_USR AND dtr.TRX_USR_SN= foph.TRX_SN AND dtr.TUN_INTERNAL_SN= foph.TRX_INT_SN );

