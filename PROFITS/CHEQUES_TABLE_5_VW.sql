CREATE VIEW CHEQUES_TABLE_5_VW ( FLG , ACC_NUMBER$ , TRX_DATE , CHEQUE_AMOUNT , DRAFT_NR$ , PRIVATE_NR$ , ENTRY_STATUS$ , ISSUER$ , BENEF$ , CARRIER$ )  AS     SELECT         1                       flg         ,        bill.bill_cr_acc_number acc_number$ ,        cheques_for_collec.trx_date         ,        cheques_for_collec.cheque_amount    ,        DECODE ( cheques_for_collec.cheque_type , 'D' , TRIM ( cheques_for_collec.cheque_number )           ||         '/ '           ||            TRIM ( cheques_for_collec.drawn_bank ) ) draft_nr$ ,        DECODE ( cheques_for_collec.cheque_type , 'P' , TRIM ( cheques_for_collec.cheque_number )           ||         '/ '           ||            TRIM ( cheques_for_collec.drawn_bank ) )                                                                                                                                                                                                                                                                                          private_nr$ ,        CAST ( DECODE ( cheques_for_collec.entry_status , 0 , 'Cancelled ' , 1 , 'Received For Collection' , 4 , 'Sent To Correspondent' , 7 , 'Paid Off by Correspondent' , 3 , 'Received By The Clearing Agent' , 6 , 'Unpaid by Correspondent' , 8 , 'Paid to Customer' , 2 , 'Send To The Clearing Agent' ) AS VARCHAR ( 30 ) ) entry_status$ ,        TRIM ( bill_issuer.biss_firstname )           ||         ' '           ||            TRIM ( bill_issuer.biss_title ) issuer$ ,        ' '                                benef$  ,        TRIM ( bill.bill_carrier_name )           ||         ' '           ||            TRIM ( bill.bill_carrier_title ) carrier$     FROM         bill               bill               ,        bill_issuer        bill_issuer        ,        cheques_for_collec cheques_for_collec ,        profits_account    profits_account     --    WHERE     bill.fk_biss_code = bill_issuer.biss_code(+)
   --          AND bill.bill_cr_acc_number = profits_account.account_number(+)
   --          AND cheques_for_collec.cfc_bill_serial_num = bill.bill_serial_num
         UNION ALL           SELECT         2                              flg         ,        profits_account.account_number acc_number$ ,        cheques_for_collec.trx_date                ,        cheques_for_collec.cheque_amount           ,        DECODE ( cheques_for_collec.cheque_type , 'D' , TRIM ( cheques_for_collec.cheque_number )           ||         '/ '           ||            TRIM ( cheques_for_collec.drawn_bank ) ) draft_nr$ ,        DECODE ( cheques_for_collec.cheque_type , 'P' , TRIM ( cheques_for_collec.cheque_number )           ||         '/ '           ||            TRIM ( cheques_for_collec.drawn_bank ) )                                                                                                                                                                                                                                                                                          private_nr$ ,        CAST ( DECODE ( cheques_for_collec.entry_status , 0 , 'Cancelled ' , 1 , 'Received For Collection' , 4 , 'Sent To Correspondent' , 7 , 'Paid Off by Correspondent' , 3 , 'Received By The Clearing Agent' , 6 , 'Unpaid by Correspondent' , 8 , 'Paid to Customer' , 2 , 'Send To The Clearing Agent' ) AS VARCHAR ( 30 ) ) entry_status$ ,        'ISSUER BLANK'                                                                                                                                                                                                                                                                                                                       issuer$       ,        ' '                                                                                                                                                                                                                                                                                                                                  benef$        ,        cheques_for_collec.bearer_name     FROM         cheques_for_collec cheques_for_collec ,        fx_ft_recording    fx_ft_recording    ,        profits_account    profits_account     WHERE         fx_ft_recording.target_dep_account = profits_account.dep_acc_number        AND         cheques_for_collec.cheque_number IN ( fx_ft_recording.cheque_number1 ,                                             fx_ft_recording.cheque_number3  ,                                             fx_ft_recording.cheque_number2  ,                                             fx_ft_recording.cheque_number4  ,                                             fx_ft_recording.cheque_number5  ,                                             fx_ft_recording.cheque_number6  ,                                             fx_ft_recording.cheque_number7  ,                                             fx_ft_recording.cheque_number8  ,                                             fx_ft_recording.cheque_number9  ,                                             fx_ft_recording.cheque_number10 )        AND         cheques_for_collec.bill_serial_num = 0        AND         profits_account.prft_system = 3           UNION ALL           SELECT         3                              flg                                                                                                                                                                                                                                                       ,        profits_account.account_number acc_number$                                                                                                                                                                                                                                               ,        fx_ft_recording.trx_date                                                                                                                                                                                                                                                                 ,        incoming_drafts.draft_amount_lc                                                                                                                                                                                                                                                          ,        incoming_drafts.bank_draft_no                                                                                                                                                                                                                                              draft_nr$     ,        ' '                                                                                                                                                                                                                                                                        private_nr$   ,        CAST ( DECODE ( incoming_drafts.entry_status , 2 , 'Lost' , 0 , 'Cancelled' , 1 , 'Issued' , 9 , 'Stolen + Reimbursed' , 8 , 'Lost + Reimbursed' , 4 , 'Stop Payment - ' , 5 , '' , 3 , 'Stolen' , 7 , 'Paid Off' , 'D' , ' ' ) AS VARCHAR ( 30 ) ) entry_status$ ,        ' '                                                                                                                                                                                                                                                                        issuer$       ,        ' '                                                                                                                                                                                                                                                                        benef$        ,        TRIM ( customer.surname )            ||         ' '            ||            TRIM ( customer.first_name )     FROM         fx_ft_recording fx_ft_recording ,        incoming_drafts incoming_drafts ,        profits_account profits_account ,        customer     WHERE         fx_ft_recording.bank_draft_num1 = incoming_drafts.bank_draft_no        AND         fx_ft_recording.source_dep_account = profits_account.dep_acc_number        AND         fx_ft_recording.trx_code = 9021        AND         profits_account.prft_system = 3        AND         fx_ft_recording.trx_customer_code = customer.cust_id;

