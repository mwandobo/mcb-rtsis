CREATE VIEW LOAN_DIRECTORS_VW_BCK  (     EOM_DATE,     ACCOUNT_NUMBER,     AGREEMENT_NUMBER,     BORROWER_ID,     BORROWER_NAME,     BORROWER_PIN_NO,     DIRECTOR_ID,     DIRECTOR_NAME,     DIRECTOR_PIN_NO  )  AS     WITH cust          AS (SELECT cust_id,                     TRIM (surname) || ' ' || TRIM (first_name) fullname,                     afm_no,                     cust_type                FROM customer                     LEFT JOIN other_afm                        ON (    cust_id = other_afm.fk_customercust_id                            AND main_flag = '1')),          dir          AS (SELECT loans_benefs_vw.cust_id,                     type_id,                     account_number agreement_number,                     related_cust_id directors_id,                     related_full_name directors_name,                     related_afm_no directors_pin_no                FROM loans_benefs_vw                     INNER JOIN cust_relationship_vw                        ON (loans_benefs_vw.cust_id =                               cust_relationship_vw.cust_id)                     INNER JOIN cust                        ON (cust.cust_id = cust_relationship_vw.cust_id)               WHERE cust.cust_type = '2' AND type_id = 'REPRESENTS'),          ben          AS (SELECT account_number,                     cust_type,                     loans_benefs_vw.cust_id borrower_id,                     fullname borrower_name,                     afm_no borrower_pin_no                FROM loans_benefs_vw                     INNER JOIN cust                        ON (loans_benefs_vw.cust_id = cust.cust_id))     SELECT eom_date,            eom_loans.account_number,            eom_loans.agreement_number,            NVL (borrower_id, 0) borrower_id,            NVL (borrower_name, ' ') borrower_name,            NVL (borrower_pin_no, ' ') borrower_pin_no,            NVL (directors_id, 0) director_id,            NVL (directors_name, ' ') director_name,            NVL (directors_pin_no, ' ') director_pin_no       FROM eom_loans            LEFT JOIN ben               ON (    ben.account_number = eom_loans.agreement_number                   AND eom_loans.agreement_system = 19)            LEFT JOIN dir               ON (    dir.cust_id = eom_loans.cust_id                   AND dir.agreement_number = eom_loans.agreement_number);

