CREATE VIEW W_FACT_GL_TRN  AS  SELECT glg_final_trn.fk_usrcode trx_user           ,glg_final_trn.fk_unitcode trx_unit           ,trn_date trx_date           ,line_num trx_sn           ,trn_snum tun_internal_sn           ,CAST (current TIMESTAMP AS TIMESTAMP) tmstamp           ,glg_final_trn.fk_glg_accountacco account_id           ,DECODE (glg_final_trn.entry_type, '1', 05021, 05024) trx_code           ,glg_final_trn.fk_currencyid_curr currency_id           ,currency.short_descr currency           ,  DECODE (glg_final_trn.entry_type, '1', 1)            * DECODE (glg_entep_ctl.fk_glg_accountacc1                     ,glg_final_trn.fk_glg_accountacco, 1)            * amount               cash_debit_amt           ,  DECODE (glg_final_trn.entry_type, '2', 1)            * DECODE (glg_entep_ctl.fk_glg_accountacc1                     ,glg_final_trn.fk_glg_accountacco, 1)            * amount               cash_credit_amt           ,  DECODE (glg_final_trn.entry_type, '1', 1)            * DECODE (glg_entep_ctl.fk_journal_interme                     ,glg_final_trn.fk_glg_accountacco, 1)            * amount               journal_debit_amt           ,  DECODE (glg_final_trn.entry_type, '2', 1)            * DECODE (glg_entep_ctl.fk_journal_interme                     ,glg_final_trn.fk_glg_accountacco, 1)            * amount               journal_credit_amt           ,DECODE (subsystem                   ,'03', 'Deposits'                   ,'04', 'Loans'                   ,'05', 'G/L'                   ,subsystem)               subsystem_ind           ,valeur_date value_date           ,remarks comments           ,gl_trn_date           ,trn_date         FROM   glg_final_trn            LEFT JOIN glg_entep_ctl ON (1 = 1)            LEFT JOIN currency               ON currency.id_currency = glg_final_trn.fk_currencyid_curr            LEFT JOIN prft_transaction               ON prft_transaction.id_transact =                     DECODE (glg_final_trn.entry_type, '1', 05021, 05024)  --WHERE subsystem = '05'
WITH NO ROW MOVEMENT;

