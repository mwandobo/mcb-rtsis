CREATE VIEW W_FACT_COLLAT_TRX  AS  SELECT coll_trx_recording.trx_usr trx_user          ,coll_trx_recording.trx_unit          ,coll_trx_recording.trx_date          ,trx_usr_sn trx_sn          ,tun_internal_sn tun_internal_sn          ,coll_trx_recording.channel_id          ,coll_trx_recording.totals_currency currency_id          ,currency.short_descr currency          ,trx_code          ,coll_trx_recording.id_product product_code          ,coll_trx_recording.id_justific justification_code          ,DECODE (NVL (transaction_status, ' '), ' ', 'Posted')              transaction_status_flag          ,coll_trx_recording.journal_db_tot_amnt journal_debit_amt          ,coll_trx_recording.journal_cr_tot_amnt journal_credit_amt          ,justific.description justification_name          ,prft_transaction.description transaction_name          ,coll_trx_recording.authorizer1          ,coll_trx_recording.authorizer2        FROM   coll_trx_recording           LEFT JOIN currency              ON currency.id_currency = coll_trx_recording.totals_currency           LEFT JOIN justific              ON justific.id_justific = coll_trx_recording.id_justific           LEFT JOIN prft_transaction              ON prft_transaction.id_transact = coll_trx_recording.trx_code        WHERE  coll_trx_recording.id_currency_1 <> 0  WITH NO ROW MOVEMENT;

