CREATE VIEW W_FACT_DEP_ACCT_LEDGER  AS  SELECT profits_account.account_ser_num acct_key          ,profits_account.dep_acc_number          ,account_demand_type          ,entry_ser_num          ,trans_ser_num          ,trx_date          ,id_justific justific_id          ,id_transact transaction_id          ,DECODE (debit_credit_flag, '1', 'Debit', 'Credit')              debit_credit_flag          ,entry_comments          ,trx_unit          ,trx_usr trx_user          ,trx_sn          ,value_date          ,entry_amount          ,prev_acc_balance          ,COALESCE (account_currency, movement_currency) account_currency_id          ,DECODE (debit_credit_flag, '1', -1, 1) * entry_amount effective_amt          ,DECODE (reversed_trx_flag, '1', 'Reversed', 'Posted') reversed_flag          ,DECODE (reverse_flag, '1', 'Reversal', 'Original') reverse_flag          ,DECODE (not_printed_flg, '0', 'Printed', 'Not Printed')              printed_flag          ,availability_date        FROM   (    SELECT 'Demand' account_demand_type                  ,fk_deposit_accoacc AS dep_acc_number                  ,entry_ser_num                  ,trans_ser_num                  ,trx_date                  ,id_justific                  ,id_transact                  ,debit_credit_flag                  ,entry_comments                  ,trx_unit                  ,trx_usr                  ,trx_sn                  ,value_date                  ,entry_amount                  ,prev_acc_balance                  ,account_currency                  ,reverse_flag                  ,reversed_trx_flag                  ,not_printed_flg                  ,fst_demand_extrait.availability_date                FROM   fst_demand_extrait                UNION ALL                SELECT 'Time Deposit' account_demand_type                  ,fk_deposit_accoacc dep_acc_number                  ,entry_ser_num                  ,trans_ser_num                  ,trx_date                  ,id_justific                  ,id_transact                  ,debit_credit_flag                  ,entry_comments                  ,trx_unit                  ,trx_usr                  ,trx_sn                  ,value_date                  ,entry_amount                  ,prev_acc_balance                  ,NULL account_currency                  ,reverse_flag                  ,'0' reversed_trx_flag                  ,not_printed_flg AS not_printed_flag                  ,time_depos_extrait.availability_date                FROM   time_depos_extrait                WHERE  time_depos_extrait.particip_bal_flag = 1) t           LEFT JOIN profits_account ON (profits_account.dep_acc_number = t.dep_acc_number )        WHERE  profits_account.prft_system = 3 AND t.dep_acc_number > 0  WITH NO ROW MOVEMENT;

