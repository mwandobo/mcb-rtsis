CREATE VIEW W_FACT_SDB_TRX  AS  SELECT sdb_trx_recording.trx_usr trx_user          ,sdb_trx_recording.trx_unit          ,sdb_trx_recording.trx_date          ,trx_sn trx_sn          ,trx_internal_sn tun_internal_sn          ,sdb_trx_recording.tmstamp          ,sdb_trx_recording.id_channel channel_id          ,sdb_trx_recording.ut1_id_currency currency_id          ,currency.short_descr currency          ,sdb_trx_recording.id_product product_code          ,sdb_trx_recording.id_transact trx_code          ,sdb_trx_recording.id_justific justification_code          ,sdb_trx_recording.ut1_cash_db_amn cash_debit_amt          ,sdb_trx_recording.ut1_cash_cr_amn cash_credit_amt          ,sdb_trx_recording.ut1_journal_db_amn journal_debit_amt          ,sdb_trx_recording.ut1_journal_cr_amn journal_credit_amt          ,sdb_trx_recording.i_trx_comments comments          ,justific.description justification_name          ,prft_transaction.description transaction_name          ,sdb_trx_recording.commission_amn commission_amt          ,sdb_trx_recording.expense_amn expense_amt        FROM   sdb_trx_recording           LEFT JOIN currency              ON currency.id_currency = sdb_trx_recording.ut1_id_currency           LEFT JOIN justific              ON justific.id_justific = sdb_trx_recording.id_justific           LEFT JOIN prft_transaction              ON prft_transaction.id_transact = sdb_trx_recording.id_transact  -- WHERE sdb_trx_recording.trx_internal_sn = 1
WITH NO ROW MOVEMENT;

