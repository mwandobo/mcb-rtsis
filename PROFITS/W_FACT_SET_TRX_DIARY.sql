CREATE VIEW W_FACT_SET_TRX_DIARY  AS  WITH trx          AS (    SELECT 'Deposits' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,comments                    ,account_no                    ,value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,reversed_tun                    ,transaction_status_flag                    ,w_fact_dep_trx.acct_key                    ,financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,cheque_num cheque_number                    ,commission_amt                    ,expense_amt                    ,tax_amt                    ,trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,authorizer1                    ,authorizer2                  FROM   w_fact_dep_trx                  UNION ALL                  SELECT 'Loans' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,NULL comments                    ,account_no                    ,value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,reversed_tun                    ,transaction_status_flag                    ,acct_key                    ,financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,commission_amt                    ,expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,authorizer1                    ,authorizer2                  FROM   w_fact_loan_trx                  UNION ALL                  SELECT 'F/X F/T' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,NULL comments                    ,account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,reversed_tun                    ,transaction_status_flag                    ,w_fact_fx_ft_trx.acct_key                    ,financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,commission_amt                    ,expense_amt                    ,tax_on_commission_amt + tax_on_expense_amt tax_amt                    ,NULL trn_type_ind                    ,loan_trx_sn                    ,source_target_ind source_target_ind                    ,authorizer1                    ,authorizer2                  FROM   w_fact_fx_ft_trx                  UNION ALL                  SELECT 'Bills' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,NULL tun_internal_sn                    ,grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,NULL comments                    ,NULL account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,NULL reversed_tun                    ,NULL transaction_status_flag                    ,NULL acct_key                    ,'Financial' financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,commission_amt                    ,expense_amt                    ,tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,authorizer1                    ,authorizer2                  FROM   w_fact_bill_trx                  UNION ALL                  SELECT 'L/G' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,NULL channel_id                    ,trx_code                    ,transaction_name                    ,NULL product_code                    ,justification_code                    ,justification_name                    ,NULL comments                    ,account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,reversed_tun                    ,transaction_status_flag                    ,acct_key                    ,'Financial' financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,' ' authorizer1                    ,' ' authorizer2                  FROM   w_fact_lg_trx                  UNION ALL                  SELECT 'Loans Autopay' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,NULL comments                    ,account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,NULL reversed_tun                    ,transaction_status_flag                    ,acct_key                    ,'Financial' financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,' ' authorizer1                    ,' ' authorizer2                  FROM   w_fact_loan_autopay_trx                  UNION ALL                  SELECT 'S.D.B' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,comments                    ,NULL account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,NULL reversal_flag                    ,NULL reversed_tun                    ,NULL transaction_status_flag                    ,NULL acct_key                    ,'Financial' financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,commission_amt                    ,expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,' ' authorizer1                    ,' ' authorizer2                  FROM   w_fact_sdb_trx                  UNION ALL                  SELECT 'Mnt.' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,NULL tun_internal_sn                    ,grp_subscript                    ,tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,comments                    ,NULL account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,NULL reversed_tun                    ,NULL transaction_status_flag                    ,NULL acct_key                    ,financial_flag                    ,NULL cash_debit_amt                    ,NULL cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,authorizer1                    ,authorizer2                  FROM   w_fact_mnt                  UNION ALL                  SELECT 'Collaterals' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,NULL tmstamp                    ,channel_id                    ,trx_code                    ,transaction_name                    ,product_code                    ,justification_code                    ,justification_name                    ,NULL comments                    ,NULL account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,NULL reversal_flag                    ,NULL reversed_tun                    ,transaction_status_flag                    ,NULL acct_key                    ,'Financial' financial_flag                    ,NULL cash_debit_amt                    ,NULL cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,authorizer1                    ,authorizer2                  FROM   w_fact_collat_trx                  UNION ALL                  SELECT 'G/L' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,NULL channel_id                    ,trx_code                    ,NULL transaction_name                    ,NULL product_code                    ,NULL justification_code                    ,NULL justification_name                    ,comments                    ,NULL account_no                    ,value_date                    ,currency                    ,currency_id                    ,NULL reversal_flag                    ,NULL reversed_tun                    ,NULL transaction_status_flag                    ,NULL acct_key                    ,'Financial' financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,' ' authorizer1                    ,' ' authorizer2                  FROM   w_fact_gl_trn                  UNION ALL                  SELECT 'C/P' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,NULL channel_id                    ,trx_code                    ,NULL transaction_name                    ,product_code                    ,justification_code                    ,NULL justification_name                    ,comments                    ,account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,NULL reversal_flag                    ,reversed_tun                    ,transaction_status_flag                    ,w_fact_cp_trx.acct_key                    ,'Financial' financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,' ' authorizer1                    ,' ' authorizer2                  FROM   w_fact_cp_trx                  UNION ALL                  SELECT 'Trade Finance' sybsystem                    ,trx_date                    ,trx_unit                    ,trx_user                    ,trx_sn                    ,tun_internal_sn                    ,NULL grp_subscript                    ,tmstamp                    ,NULL channel_id                    ,trx_code                    ,transaction_name                    ,NULL product_code                    ,justification_code                    ,justification_name                    ,comments                    ,account_no                    ,NULL value_date                    ,currency                    ,currency_id                    ,reversal_flag                    ,NULL reversed_tun                    ,transaction_status_flag                    ,acct_key                    ,financial_flag                    ,cash_debit_amt                    ,cash_credit_amt                    ,journal_debit_amt                    ,journal_credit_amt                    ,NULL cheque_number                    ,NULL commission_amt                    ,NULL expense_amt                    ,NULL tax_amt                    ,NULL trn_type_ind                    ,0 loan_trx_sn                    ,'n/a' source_target_ind                    ,' ' authorizer1                    ,' ' authorizer2                  FROM   w_fact_tf_trx)         SELECT sybsystem           ,trx_date           ,trx_unit           ,trx_user           ,trx_sn           ,tun_internal_sn           ,grp_subscript           ,tmstamp           ,channel_id           ,trx_code           ,transaction_name           ,product_code           ,justification_code           ,justification_name           ,comments           ,account_no           ,value_date           ,currency           ,currency_id           ,reversal_flag           ,reversed_tun           ,transaction_status_flag           ,acct_key           ,financial_flag           ,cash_debit_amt           ,cash_credit_amt           ,journal_debit_amt           ,journal_credit_amt           ,cheque_number           ,commission_amt           ,expense_amt           ,tax_amt           ,commission_amt + expense_amt + tax_amt total_charges_amt           ,trn_type_ind           ,loan_trx_sn           ,source_target_ind source_target_ind           ,authorizer1           ,authorizer2         FROM   trx  WITH NO ROW MOVEMENT;

