CREATE VIEW W_FACT_BILL_TRX  AS  SELECT bill_trx_recording.trx_date          ,bill_trx_recording.trx_unit          ,bill_trx_recording.trx_user trx_user          ,bill_trx_recording.trx_usr_sn trx_sn          ,bill_trx_recording.grp_subscript          ,bill_trx_recording.tmstamp          ,bill_trx_recording.channel_id          ,bill_trx_recording.id_product product_code          ,bill_trx_recording.trx_code          ,bill_trx_recording.id_justific justification_code          ,bill_currency_id currency_id          ,currency.short_descr currency          ,bill_trx_recording.cash_db_amn cash_debit_amt          ,bill_trx_recording.cash_cr_amn cash_credit_amt          ,bill_trx_recording.journal_db_amn journal_debit_amt          ,bill_trx_recording.journal_cr_amn journal_credit_amt          ,DECODE (NVL (bill_trx_recording.reversal_flag, '0')                  ,'1', 'Reversal'                  ,'Original')              reversal_flag          ,justific.description justification_name          ,prft_transaction.description transaction_name          ,acc_amount_1 + acc_amount_2 + acc_amount_3 commission_amt          ,acc_amount_4 + acc_amount_5 + acc_amount_6 expense_amt          ,acc_amount_7 + acc_amount_8 + acc_amount_9 tax_amt          ,acc_amount_10 total_charges_amt          ,bill_trx_recording.authorizer1          ,bill_trx_recording.authorizer2        FROM   bill_trx_recording           LEFT JOIN currency              ON currency.id_currency = bill_trx_recording.bill_currency_id           LEFT JOIN justific              ON justific.id_justific = bill_trx_recording.id_justific           LEFT JOIN prft_transaction              ON prft_transaction.id_transact = bill_trx_recording.trx_code           LEFT JOIN mnt_recording              ON (    bill_trx_recording.grp_subscript =                         mnt_recording.grp_subscript                  AND bill_trx_recording.trx_date = mnt_recording.trx_date                  AND bill_trx_recording.trx_usr_sn = mnt_recording.trx_usr_sn                  AND bill_trx_recording.trx_user = mnt_recording.trx_user                  AND bill_trx_recording.trx_unit = mnt_recording.trx_unit                  AND mnt_recording.id_product = 16001                  AND mnt_recording.acc_amount_10 <> 0                  AND mnt_recording.prft_system = 16)  WITH NO ROW MOVEMENT;

