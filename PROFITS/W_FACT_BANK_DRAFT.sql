CREATE VIEW W_FACT_BANK_DRAFT  AS  SELECT outgoing_drafts.issue_date          ,TRUNC (outgoing_drafts.tmstamp) draft_trx_date          ,outgoing_drafts.tmstamp draft_trx_timestamp          ,SUBSTR (short_descr, 1, 3) draft_currency_code          ,outgoing_drafts.benef_name          ,cust.swift_address receiver_bank_bic          ,outgoing_drafts.fk_swmsg_prftrefno profits_ref_no          ,outgoing_drafts.bank_draft_no          ,outgoing_drafts.trx_date          ,outgoing_drafts.draft_amount          ,outgoing_drafts.draft_amount_lc draft_amount_lcy          ,profits_account.account_number          ,outgoing_drafts.fk1customercust_id cust_id          ,SUBSTR (cust.swift_address, 5, 2) receiver_country_code          ,outgoing_drafts.entry_status        FROM   bank_parameters          ,outgoing_drafts           LEFT JOIN customer cust              ON outgoing_drafts.fk_customercust_id = cust.cust_id           LEFT JOIN currency              ON (outgoing_drafts.fk_currencyid_curr = id_currency)           LEFT JOIN swift_110              ON (outgoing_drafts.fk_swmsg_prftrefno =                     swift_110.fk_swmsg_prftrefno)           LEFT JOIN profits_account              ON     profits_account.dep_acc_number =                        outgoing_drafts.fk0deposit_accoacc                 AND profits_account.prft_system = 3        WHERE  outgoing_drafts.entry_status IN ('1'                                           ,'5'                                           ,'6'                                           ,'7')  WITH NO ROW MOVEMENT;

